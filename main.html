<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Tasks</title>
</head>
<body class="container">
<p class="font-weight-lighter text-monospace mt-3">
	Задача: разработать приложение-задачник по модели MVC
</p>

<div class="row">

<div class="col-6">
<nav aria-label="Сортировка" class="navbar navbar-expand">
	<span class="navbar-brand">Задачник</span>

	<ul class="navbar-nav">
		<li class="nav-item">
			<span class="nav-link disabled">
			Сортировка&nbsp;по</span>
		<li>
		<li class="nav-item dropdown">
			<a href="#" class="nav-link dropdown-toggle"
			data-toggle="dropdown"
			aria-haspopup="true">Дате</a>

<div class="dropdown-menu">
	<span class="dropdown-item disabled">Дате добавления</span>
	<a class="dropdown-item" href="#">Имени</a>
	<a class="dropdown-item" href="#">Email</a>
	<a class="dropdown-item" href="#">Статусу</a>
</div>

		</li>
		<li class="nav-item">
			<a class="nav-link" href="#">по&nbsp;возрастанию</a>
		</li>
	</ul>
</nav>

<ul class="list-group">
	<li class="list-group-item">
		<div class="mb-2">
			Кирилл Осиюк
		</div>
		<div class="mb-2">
			kiril.saradomin@gmail.com
		</div>
		<div class="mb-2">
			Сверстать карточку задачи
		</div>

		<div class="mb-3">
		<span class="badge badge-pill badge-success">выполнено</span>
		<span class="badge badge-pill badge-light">отредактировано администратором</span>
		</div>

		<div class="mb-1">
		<button type="button" class="btn btn-warning">Изменить</button>
		<button type="button" class="btn btn-success">Выполнить</button>
		<button type="button" class="btn btn-danger">Удалить</button>
		</div>
	</li>

	<li class="list-group-item">
		<div class="mb-2">
			Кирилл Осиюк
		</div>
		<div class="mb-2">
			kiril.saradomin@gmail.com
		</div>

		<div class="mb-3">
			<input class="col-9 form-control d-inline-block"
			type="text" name="text"
			value="Сверстать карточку задачи">
		</div>

		<div class="mb-3">
		<span class="badge badge-pill badge-success">выполнено</span>
		<span class="badge badge-pill badge-light">отредактированно администратором</span>
		</div>

		<div class="mb-1">
		<button type="button" class="btn btn-light">Отменить</button>
		<button type="button" class="btn btn-danger">Сохранить</button>
		</div>
	</li>
</ul>

<nav aria-label="Пагинация" class="my-4">
	<ul class="pagination">
		<li class="page-item disabled">
			<span class="page-link">Назад</span>
		</li>
		<li class="page-item active" aria-current="page">
			<span class="page-link">1</span>
		</li>
		<li class="page-item">
			<a class="page-link" href="#">2</a>
		</li>
		<li class="page-item">
			<a class="page-link" href="#">Вперед</a>
		</li>
	</ul>
</nav>
</div>

<?php

function if_error(string $key) : bool
{
	global $errors;

	return is_array($errors) && array_key_exists($key, $errors);
}

function validate_error(string $key) : string
{
	global $errors;

	if (!if_error($key))
		return '';

	if (1 == $errors[$key]) switch ($key) {
		case 'username': $message = 'пустое'; break;
		case 'email': $message = 'пустой'; break;
		case 'text': $message = 'пустая'; break;
	}

	if (2 == $errors[$key]) switch ($key) {
		case 'username': $message = 'не верно'; break;
		case 'email': $message = 'не верен'; break;
		case 'text': $message = 'не верна'; break;
	}

	return '<span class="text-danger">' . $message . '</span>';
}

?>

<form class="col-3" method="POST">
	<input type="hidden" name="method" value="new_task">

	<?php if (isset($task_created) && $task_created > 0) : ?>
	<div class="form-group">
		<span class="text-success">
		Задача <?= $task_created ?> успешно добавлена</span>
	</div>
	<?php endif ?>

	<div class="form-group">
		<label class="d-block">
		Имя пользователя <?= validate_error('username') ?>

		<input class="form-control <?= if_error('username') ?
			'border-danger' : '' ?>"
		value="<?= $_POST['username'] ?? $_COOKIE['USER'] ?>"
		type="text" name="username"></label>
	</div>

	<div class="form-group">
		<label class="d-block">
		Email <?= validate_error('email') ?>

		<input class="form-control <?= if_error('email') ?
			'border-danger' : '' ?>"
		value="<?= $_POST['email'] ?? $_COOKIE['EMAIL'] ?>"
		type="email" name="email"></label>
	</div>

	<div class="form-group">
		<label class="d-block">
		Задача <?= validate_error('text') ?>

		<input class="form-control <?= if_error('text') ?
			'border-danger' : '' ?>"
		value="<?php if (is_array($errors)) echo $_POST['text'] ?>"
		type="text" name="text"></label>
	</div>
	<button class="btn btn-light" type="submit">Создать</button>
</form>

<div class="col-3"><form method="POST">
	<input type="hidden" name="method" value="login">
	<div class="form-group">
		<span class="text-danger">
		Username or password or&nbsp;both are&nbsp;incorrect</span>
	</div>

	<div class="form-group">
		<label class="d-block">
		Username
		<input class="form-control border-danger"
		type="text" name="login"></label>
	</div>

	<div class="form-group">
		<label class="d-block">
		Password
		<input class="form-control border-danger"
		type="password" name="pass"></label>
	</div>
	<button class="btn btn-primary" type="submit">Login</button>
</form>

<form method="POST">
	<input type="hidden" name="method" value="logout">
	<button class="btn btn-light" type="submit">Logout</button>
</form></div>

</div>

<link rel="stylesheet" href="assets/bootstrap.css">
<script src="assets/jquery-3.5.1.slim.js" defer></script>
<script src="assets/bootstrap.js" defer></script>
</body>
</html>
